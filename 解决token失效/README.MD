# 微信消息自动发送脚本

此 Python 脚本用于通过模拟键盘操作在 Windows 系统上自动打开微信并向指定好友或群聊发送消息。以下是脚本功能和使用的概述。

## 功能

- **自动打开微信**：启动微信客户端。
- **窗口控制**：查找并激活微信主窗口，确保其处于前台。
- **搜索联系人**：通过模拟 `Ctrl+F` 搜索好友或群聊。
- **消息发送**：将指定文本复制到剪贴板，模拟 `Ctrl+V` 粘贴并通过 `Alt+S` 发送消息。
- **批量发送**：支持向多个好友或群聊发送相同消息。

## 依赖项

- Python 库：`pywin32`（提供 `win32gui`, `win32api`, `win32con`, `win32clipboard`），`time`
- 环境要求：Windows 系统，微信 PC 客户端已安装（默认路径：`C:\Program Files\Tencent\WeChat\WeChat.exe`）

## 核心函数

- `ClipboardText(aString)`：设置剪贴板内容并模拟 `Ctrl+V` 粘贴。
- `search(wxname)`：通过 `Ctrl+F` 搜索指定好友或群聊，若未找到则提示错误。
- `SendMsg()`：模拟 `Alt+S` 发送消息。
- `sendText(chatrooms, text)`：向指定联系人列表发送文本消息。

## 使用方法

1. 确保微信 PC 客户端已安装在默认路径或修改脚本中的路径。
2. 配置 `chatrooms` 列表，填入目标好友或群聊的名称（需与微信中显示的名称一致）。
3. 设置 `text` 为要发送的消息内容。
4. 运行脚本，脚本将：
   - 打开微信客户端。
   - 逐一搜索 `chatrooms` 中的联系人。
   - 将 `text` 复制到剪贴板并发送。
   - 在控制台输出发送状态。

## 示例代码

```python
chatrooms = ['文件传输助手', '一之哥哥']
text = 'token'
sendText(chatrooms, text)
```

## 注意事项

- **微信窗口句柄**：脚本依赖微信窗口标题（“微信”），若标题因版本或语言不同而变化，需修改 `FindWindow` 参数。
- **时间延迟**：脚本中使用 `time.sleep` 确保操作稳定性，可根据系统性能调整延迟时间。
- **消息格式**：为避免表情等内容复制不全，消息前会自动添加一个空格。
- **错误处理**：若未找到指定联系人，脚本会输出提示并退出。
- **依赖环境**：需确保 `pywin32` 已安装（`pip install pywin32`）。

## 示例输出

运行脚本后，控制台可能显示：

```
找到微信主窗口句柄:123456
微信消息:token 已发送至:文件传输助手
微信消息:token 已发送至:一之哥哥
```

此脚本适用于需要通过微信 PC 客户端批量发送消息的场景，如通知、提醒等自动化任务。